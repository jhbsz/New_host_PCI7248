VERSION 5.00
Begin VB.Form fmSynCardSLE4442 
   Caption         =   "Synchronous Card Control (SLE4442)"
   ClientHeight    =   7740
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   5520
   LinkTopic       =   "Form1"
   ScaleHeight     =   7740
   ScaleWidth      =   5520
   StartUpPosition =   2  'CenterScreen
   Begin VB.TextBox txtSLE4442 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   240
      TabIndex        =   7
      Top             =   2880
      Width           =   3615
   End
   Begin VB.CommandButton cmdSLE4442 
      Caption         =   "Send"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4320
      TabIndex        =   6
      Top             =   2880
      Width           =   975
   End
   Begin VB.ListBox lstSLE4442 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1740
      Left            =   240
      TabIndex        =   5
      Top             =   960
      Width           =   5055
   End
   Begin VB.TextBox Text1 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   240
      TabIndex        =   4
      Top             =   240
      Width           =   2295
   End
   Begin VB.CommandButton Command1 
      Caption         =   "PIN"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   3960
      TabIndex        =   3
      Top             =   240
      Width           =   1095
   End
   Begin VB.TextBox txtMessageBox 
      BeginProperty Font 
         Name            =   "Courier New"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   240
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   2
      Top             =   7320
      Width           =   5055
   End
   Begin VB.Label Label1 
      Caption         =   "Card Response"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   240
      TabIndex        =   8
      Top             =   3240
      Width           =   3255
   End
   Begin VB.Line Line2 
      BorderColor     =   &H80000005&
      X1              =   240
      X2              =   5040
      Y1              =   855
      Y2              =   855
   End
   Begin VB.Line Line1 
      X1              =   240
      X2              =   5040
      Y1              =   840
      Y2              =   840
   End
   Begin VB.Label lblResponse 
      Appearance      =   0  'Flat
      BackColor       =   &H00E0E0E0&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Courier New"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   3495
      Left            =   240
      TabIndex        =   0
      Top             =   3600
      Width           =   5055
   End
   Begin VB.Label Label3 
      Caption         =   "Message"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   240
      TabIndex        =   1
      Top             =   7080
      Width           =   1815
   End
End
Attribute VB_Name = "fmSynCardSLE4442"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False




Private Sub cmdSLE4442_Click()
    Dim aCommand As aSLE4442commmand
    Dim lngResult As Long
    Dim aReplyBuffer As ARRAY_TYPE
    Dim lngReplyLen As Long
        
    aCommand = Str2Command(txtSLE4442.Text)
    Select Case aCommand.bControl
        Case &H30 ' READ MAIN MEMORY
            aCommand.iReplyLen = 256 - aCommand.bAddress
        Case &H38 'UPDATE MAIN MEMORY
            aCommand.iReplyLen = 0
        Case &H34 'READ PROTECTION MEMORY
            aCommand.iReplyLen = 4
        Case &H3C 'WRITE PROTECTION MEMORY
            aCommand.iReplyLen = 0
        Case &H31 'READ SECURITY MEMORY
            aCommand.iReplyLen = 4
        Case &H39 'UPDATE SECURITY MEMORY
            aCommand.iReplyLen = 0
        Case &H33 'COMPARE VERIFICATION DATA
            aCommand.iReplyLen = 0
    End Select
    
    lngResult = SLE4442Command(aCommand, aReplyBuffer, lngReplyLen)
    If (lngResult = 0) Then
        txtMessageBox.Text = txtMessageBox.Text & lstSLE4442.Text & "  Successes!" & vbCrLf
        lblResponse.Caption = ""
        For i = 1 To lngReplyLen
            lblResponse.Caption = lblResponse.Caption & Byte2Char(aReplyBuffer.byteData(i - 1)) & " "
        Next i
    Else
        txtMessageBox.Text = txtMessageBox.Text & lstSLE4442.Text & "  failure!" & vbCrLf
        lblResponse.Caption = ""
    End If
    
    
End Sub

Private Sub Form_Load()


    lstSLE4442.AddItem "READ MAIN MEMORY"
    lstSLE4442.AddItem "UPDATE MAIN MEMORY"
    lstSLE4442.AddItem "READ PROTECTION MEMORY"
    lstSLE4442.AddItem "WRITE PROTECTION MEMORY"
    lstSLE4442.AddItem "READ SECURITY MEMORY(4442 Only)"
    lstSLE4442.AddItem "UPDATE SECURITY MEMORY(4442 only)"
    lstSLE4442.AddItem "COMPARE VERIFICATION DATA(4442 only)"
    txtMessageBox.Text = ""

    
End Sub

Private Sub lstSLE4442_Click()
    Dim iIndex As Integer
    Dim aCommand As aSLE4442commmand
    Dim lngReplyLen As Long
    
    
    iIndex = lstSLE4442.ListIndex
    
    Select Case iIndex
    
        Case 0 ' READ MAIN MEMORY
            txtSLE4442.Text = "30 00 00"
        Case 1 'UPDATE MAIN MEMORY
            txtSLE4442.Text = "38 00 00"
        Case 2 'READ PROTECTION MEMORY
            txtSLE4442.Text = "34 00 00"
        Case 3 'WRITE PROTECTION MEMORY
            txtSLE4442.Text = "3C 00 00"
        Case 4 'READ SECURITY MEMORY
            txtSLE4442.Text = "31 00 00"
        Case 5 'UPDATE SECURITY MEMORY
            txtSLE4442.Text = "39 00 07"
        Case 6 'COMPARE VERIFICATION DATA
            txtSLE4442.Text = "33 01 FF"
    End Select
    
    
    
    

End Sub
